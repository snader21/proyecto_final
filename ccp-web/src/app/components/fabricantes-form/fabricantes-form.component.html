<p-dialog 
  [header]="fabricante ? 'Editar fabricante' : 'Agregar fabricante'" 
  [modal]="true" 
  [(visible)]="visible" 
  [style]="{ width: '35rem' }"
  (onHide)="hideDialog()"
  (onShow)="loadForm()"
>
  <div *ngIf="loading" class="flex flex-col gap-4">
    <div *ngFor="let i of [1,2,3,4,5]" class="flex flex-col gap-2">
      <div class="h-4 bg-gray-200 rounded animate-pulse w-24"></div>
      <div class="h-10 bg-gray-200 rounded animate-pulse"></div>
    </div>
  </div>
  <form *ngIf="!loading" [formGroup]="form" class="flex flex-col gap-4">
    <div class="flex flex-col gap-2">
      <label for="name">Nombre</label>
      <input 
        pInputText 
        id="name" 
        formControlName="name" 
        placeholder="Ingrese el nombre del fabricante"
        [ngClass]="{'ng-invalid ng-dirty': isFieldInvalid('name')}"
      />
      <small class="text-red-500" *ngIf="isFieldInvalid('name')">
        {{ getErrorMessage('name') }}
      </small>
    </div>
    <div class="flex flex-col gap-2">
      <label for="email">Correo</label>
      <input 
        pInputText 
        id="email" 
        formControlName="email" 
        placeholder="Ingrese el correo electrónico"
        [ngClass]="{'ng-invalid ng-dirty': isFieldInvalid('email')}"
      />
      <small class="text-red-500" *ngIf="isFieldInvalid('email')">
        {{ getErrorMessage('email') }}
      </small>
    </div>
    <div class="flex flex-col gap-2">
      <label for="address">Dirección</label>
      <input 
        pInputText 
        id="address" 
        formControlName="address" 
        placeholder="Ingrese la dirección"
        [ngClass]="{'ng-invalid ng-dirty': isFieldInvalid('address')}"
      />
      <small class="text-red-500" *ngIf="isFieldInvalid('address')">
        {{ getErrorMessage('address') }}
      </small>
    </div>
    <div class="flex flex-col gap-2">
      <label for="phone">Teléfono</label>
      <input 
        pInputText 
        id="phone" 
        formControlName="phone" 
        placeholder="Ingrese el número de teléfono"
        [ngClass]="{'ng-invalid ng-dirty': isFieldInvalid('phone')}"
      />
      <small class="text-red-500" *ngIf="isFieldInvalid('phone')">
        {{ getErrorMessage('phone') }}
      </small>
    </div>
    <div class="flex flex-col gap-2">
      <label for="status">Estado</label>
      <p-select
        [options]="['Activo', 'Inactivo']"
        formControlName="status"
        placeholder="Seleccione el estado"
        class="w-full"
        appendTo="body"
        [ngClass]="{'ng-invalid ng-dirty': isFieldInvalid('status')}"
      ></p-select>
      <small class="text-red-500" *ngIf="isFieldInvalid('status')">
        {{ getErrorMessage('status') }}
      </small>
    </div>
  </form>
  <ng-template pTemplate="footer">
    <div class="flex justify-end gap-2">
      <p-button label="Cancelar" severity="secondary" (click)="hideDialog()" />
      <p-button label="Guardar fabricante" styleClass="bg-slate-700 text-white" (click)="onSubmit()" />
    </div>
  </ng-template>
</p-dialog>